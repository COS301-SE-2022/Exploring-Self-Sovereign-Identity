using ExploringSelfSovereignIdentityAPI.Models.Request;
using ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain;
using ExploringSelfSovereignIdentityAPI.Services.UserDataService;
using MediatR;
using Microsoft.Extensions.Configuration;
using Nethereum.ABI.FunctionEncoding.Attributes;
using Nethereum.Contracts;
using Nethereum.Contracts.ContractHandlers;
using Nethereum.Contracts.DeploymentHandlers;
using Nethereum.Web3;
using Nethereum.Web3.Accounts;
using Org.BouncyCastle.Asn1.Mozilla;
using Org.BouncyCastle.Asn1.Ocsp;
using System;
using System.Collections.Generic;
using System.Numerics;
using System.Threading.Tasks;
using Attribute = ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain.Attribute;
using IUserDataService = ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain.IUserDataService;

namespace ExploringSelfSovereignIdentityAPI.Services
{
    public class MarketPlaceService : IMarketPlaceService
    {

        private static string url = "http://testchain.nethereum.com:8545";

        /*private static string privateKey = "0x7580e7fb49df1c861f0050fae31c2224c6aba908e116b8da44ee8cd927b990b0";
        static Web3 web3 = new Web3(new Nethereum.Web3.Accounts.Account(privateKey, 444444444500), url);*/

        private static string privateKey;
        private static Account acc;
        private static Web3 web3;

        private static IConfiguration configuration;

        private static ContractHandler contractHandler;

        private IUserDataService userData;

        public MarketPlaceService(IUserDataService userData, IConfiguration config)
        {
            this.userData = userData;
            configuration = config;
        }

        private async Task<ContractHandler> deploy()
        {
            privateKey = configuration["accountPrivateKey"];
            acc = new Nethereum.Web3.Accounts.Account(privateKey, 444444444500);

            web3 = new Web3(acc, url);
            web3.TransactionManager.UseLegacyAsDefault = true;

            var marketPlaceDeployment = new MarketPlaceDeployment();

            var transactionReceiptDeployment = await web3.Eth.GetContractDeploymentHandler<MarketPlaceDeployment>().SendRequestAndWaitForReceiptAsync(marketPlaceDeployment);
            var contractAddress = transactionReceiptDeployment.ContractAddress;
            
            return web3.Eth.GetContractHandler(contractAddress);
        }

        public async Task<string> addDataPack(AddDataPackRequest2 request)
        {

            if (contractHandler == null) contractHandler = await deploy();

            var addDataPackFunction = new AddDataPackFunction();
            addDataPackFunction.Request = new AddDataPackRequest();
            addDataPackFunction.Request.Id = request.Id;
            addDataPackFunction.Request.PricePerUnit = request.PricePerUnit;
            addDataPackFunction.Request.Organization = request.Organization;
            addDataPackFunction.Request.RequestedAttributes = request.RequestedAttributes;
            var addDataPackFunctionTxnReceipt = await contractHandler.SendRequestAndWaitForReceiptAsync(addDataPackFunction);

            return "success";
        }

        public async Task<BuyDataOutputDTO2> buyData(BuyDataRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var buyDataFunction1 = new BuyDataFunction1();
            buyDataFunction1.Request = request;
            var vd1 = await contractHandler.QueryDeserializingToObjectAsync<BuyDataFunction1, BuyDataOutputDTO>(buyDataFunction1);

            if (vd1.ReturnValue1.Status == "success")
            {
                var buyDataFunction = new BuyDataFunction();
                buyDataFunction.Request = request;
                var buyDataFunctionTxnReceipt = await contractHandler.SendRequestAndWaitForReceiptAsync(buyDataFunction);

                await userData.updateBalance(request.UserID, (int) vd1.ReturnValue1.Amount);
            }

            BuyDataOutputDTO2 ret = new BuyDataOutputDTO2();


            //buyDataFunction.Request.Attributes.ForEach(attr => Console.WriteLine("Here: " + attr.Name));

            ret.ReturnValue1 = new BuyDataResponse2();
            ret.ReturnValue1.Status = vd1.ReturnValue1.Status;
            ret.ReturnValue1.Amount = (int) vd1.ReturnValue1.Amount;

          

            return ret;
        }

        public async Task<string> createOrganization(CreateOrgRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var createOrganizationFunction = new CreateOrganizationFunction();
            createOrganizationFunction.Request = request;
            var createOrganizationFunctionTxnReceipt = await contractHandler.SendRequestAndWaitForReceiptAsync(createOrganizationFunction);

            return "success";
        }

        public async Task<GetOrganizationOutputDTO2> getOrganization(CreateOrgRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var getOrganizationFunction = new GetOrganizationFunction();
            getOrganizationFunction.Request = request;
            var getOrganizationOutputDTO = await contractHandler.QueryDeserializingToObjectAsync<GetOrganizationFunction, GetOrganizationOutputDTO>(getOrganizationFunction);

            GetOrganizationOutputDTO2 ret = new GetOrganizationOutputDTO2();
            ret.ReturnValue1 = new OrganizationResponse2();

            ret.ReturnValue1.Id = getOrganizationOutputDTO.ReturnValue1.Id;
            ret.ReturnValue1.Balance = (int) getOrganizationOutputDTO.ReturnValue1.Balance;
            ret.ReturnValue1.Status = getOrganizationOutputDTO.ReturnValue1.Status;

            ret.ReturnValue1.Packs = new List<DataPackResponse2>();

            Console.WriteLine(getOrganizationOutputDTO.ReturnValue1.Packs.Count);

            for (int i=0; i< getOrganizationOutputDTO.ReturnValue1.Packs.Count; i++)
            {
                Console.WriteLine(getOrganizationOutputDTO.ReturnValue1.Packs[i].Received.Count);
                DataPackResponse2 p = new DataPackResponse2();
                p.Id = getOrganizationOutputDTO.ReturnValue1.Packs[i].Id;
                p.PricePerUnit = (int) getOrganizationOutputDTO.ReturnValue1.Packs[i].PricePerUnit;
                p.Received = getOrganizationOutputDTO.ReturnValue1.Packs[i].Received;

                ret.ReturnValue1.Packs.Add(p);
            }

            return ret;
        }

        public async Task<GetAllOrganizationsOutputDTO2> getAllOrganizations(string id)
        {

            if (contractHandler == null) contractHandler = await deploy();

            var getAllOrganizationsFunction = new GetAllOrganizationsFunction();
            getAllOrganizationsFunction.Id = id;
            var temp = await contractHandler.QueryDeserializingToObjectAsync<GetAllOrganizationsFunction, GetAllOrganizationsOutputDTO>(getAllOrganizationsFunction);

            //var temp = await contractHandler.QueryDeserializingToObjectAsync<GetAllOrganizationsFunction, GetAllOrganizationsOutputDTO>();

            var ret = new GetAllOrganizationsOutputDTO2();
            ret.ReturnValue1 = new List<AllOrganizationResponse2>();

            for (int i=0; i<temp.ReturnValue1.Count; i++)
            {
                Console.WriteLine(temp.ReturnValue1[i].Id);
                Console.WriteLine(temp.ReturnValue1[i].Organization);

                AllOrganizationResponse2 p = new AllOrganizationResponse2();

                if (temp.ReturnValue1[i].Organization == "") continue;

                p.Id = temp.ReturnValue1[i].Id;
                p.PricePerUnit = (int) temp.ReturnValue1[i].PricePerUnit;
                p.Organization = temp.ReturnValue1[i].Organization;

                p.Attributes = temp.ReturnValue1[i].Attributes;
                
                ret.ReturnValue1.Add(p);
            }

            return ret;
        }
    }

    public partial class MarketPlaceDeployment : MarketPlaceDeploymentBase
    {
        public MarketPlaceDeployment() : base(BYTECODE) { }
        public MarketPlaceDeployment(string byteCode) : base(byteCode) { }
    }

    public class MarketPlaceDeploymentBase : ContractDeploymentMessage
    {
        public static string BYTECODE = "0x608060405234801561001057600080fd5b5061302a806100206000396000f3fe608060405234801561001057600080fd5b50600436106100625760003560e01c8063119fcf031461006757806317d104f81461009757806320b0a34b146100b357806373001f80146100e3578063804a18b8146101135780638d0f9c681461012f575b600080fd5b610081600480360381019061007c9190612195565b61014b565b60405161008e91906122bc565b60405180910390f35b6100b160048036038101906100ac91906124b7565b610501565b005b6100cd60048036038101906100c89190612500565b610704565b6040516100da919061273e565b60405180910390f35b6100fd60048036038101906100f891906127e8565b610d93565b60405161010a9190612bc7565b60405180910390f35b61012d60048036038101906101289190612195565b6116e3565b005b610149600480360381019061014491906127e8565b611bea565b005b610153611d1c565b61015b611d1c565b60005b600384602001516040516101729190612c25565b9081526020016040518091039020600301548110156104f65761025a600385602001516040516101a29190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060000180546101d290612c6b565b80601f01602080910402602001604051908101604052809291908181526020018280546101fe90612c6b565b801561024b5780601f106102205761010080835404028352916020019161024b565b820191906000526020600020905b81548152906001019060200180831161022e57829003601f168201915b50505050508560400151611cf1565b156104e35760005b600385602001516040516102769190612c25565b90815260200160405180910390206004016000838152602001908152602001600020600401548110156103e757610386600386602001516040516102ba9190612c25565b90815260200160405180910390206004016000848152602001908152602001600020600501600083815260200190815260200160002060000180546102fe90612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461032a90612c6b565b80156103775780601f1061034c57610100808354040283529160200191610377565b820191906000526020600020905b81548152906001019060200180831161035a57829003601f168201915b50505050508660000151611cf1565b156103d4576040518060400160405280600681526020017f6661696c6564000000000000000000000000000000000000000000000000000081525083600001819052508293505050506104fc565b80806103df90612ccb565b915050610262565b506040518060400160405280600781526020017f737563636573730000000000000000000000000000000000000000000000000081525082600001819052506003846020015160405161043a9190612c25565b90815260200160405180910390206004016000828152602001908152602001600020600101548260200181815250506003846020015160405161047d9190612c25565b9081526020016040518091039020600401600082815260200190815260200160002060010154600385602001516040516104b79190612c25565b908152602001604051809103902060020160008282546104d79190612d13565b925050819055506104f6565b80806104ee90612ccb565b91505061015e565b50809150505b919050565b6000600382600001516040516105179190612c25565b9081526020016040518091039020600301600081548092919061053990612ccb565b9190505590508160200151600383600001516040516105589190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060000190816105899190612ef3565b508160400151600383600001516040516105a39190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060010181905550816060015151600383600001516040516105e69190612c25565b90815260200160405180910390206004016000838152602001908152602001600020600201819055506000600383600001516040516106259190612c25565b908152602001604051809103902060040160008381526020019081526020016000206004018190555060005b8260600151518110156106e7578260600151818151811061067557610674612fc5565b5b6020026020010151600384600001516040516106919190612c25565b90815260200160405180910390206004016000848152602001908152602001600020600301600083815260200190815260200160002090816106d39190612ef3565b5080806106df90612ccb565b915050610651565b50600160008154809291906106fb90612ccb565b91905055505050565b6060600060015467ffffffffffffffff81111561072457610723611e05565b5b60405190808252806020026020018201604052801561075d57816020015b61074a611d36565b8152602001906001900390816107425790505b509050606060005b600054811015610d885760026000828152602001908152602001600020805461078d90612c6b565b80601f01602080910402602001604051908101604052809291908181526020018280546107b990612c6b565b80156108065780601f106107db57610100808354040283529160200191610806565b820191906000526020600020905b8154815290600101906020018083116107e957829003601f168201915b50505050509150600060038360405161081f9190612c25565b908152602001604051809103902060030154905060005b81811015610d73576000805b6003866040516108529190612c25565b90815260200160405180910390206004016000848152602001908152602001600020600401548110156109775761095a6003876040516108929190612c25565b90815260200160405180910390206004016000858152602001908152602001600020600501600083815260200190815260200160002060000180546108d690612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461090290612c6b565b801561094f5780601f106109245761010080835404028352916020019161094f565b820191906000526020600020905b81548152906001019060200180831161093257829003601f168201915b50505050508a611cf1565b1561096457600191505b808061096f90612ccb565b915050610842565b5080156109845750610d60565b6003856040516109949190612c25565b908152602001604051809103902060000180546109b090612c6b565b80601f01602080910402602001604051908101604052809291908181526020018280546109dc90612c6b565b8015610a295780601f106109fe57610100808354040283529160200191610a29565b820191906000526020600020905b815481529060010190602001808311610a0c57829003601f168201915b5050505050868381518110610a4157610a40612fc5565b5b602002602001015160000181905250600385604051610a609190612c25565b908152602001604051809103902060040160008381526020019081526020016000206000018054610a9090612c6b565b80601f0160208091040260200160405190810160405280929190818152602001828054610abc90612c6b565b8015610b095780601f10610ade57610100808354040283529160200191610b09565b820191906000526020600020905b815481529060010190602001808311610aec57829003601f168201915b5050505050868381518110610b2157610b20612fc5565b5b602002602001015160200181905250600385604051610b409190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060010154868381518110610b7957610b78612fc5565b5b602002602001015160400181815250506000600386604051610b9b9190612c25565b908152602001604051809103902060040160008481526020019081526020016000206002015490508067ffffffffffffffff811115610bdd57610bdc611e05565b5b604051908082528060200260200182016040528015610c1057816020015b6060815260200190600190039081610bfb5790505b50878481518110610c2457610c23612fc5565b5b60200260200101516060018190525060005b81811015610d5c57600387604051610c4e9190612c25565b9081526020016040518091039020600401600085815260200190815260200160002060030160008281526020019081526020016000208054610c8f90612c6b565b80601f0160208091040260200160405190810160405280929190818152602001828054610cbb90612c6b565b8015610d085780601f10610cdd57610100808354040283529160200191610d08565b820191906000526020600020905b815481529060010190602001808311610ceb57829003601f168201915b5050505050888581518110610d2057610d1f612fc5565b5b6020026020010151606001518281518110610d3e57610d3d612fc5565b5b60200260200101819052508080610d5490612ccb565b915050610c36565b5050505b8080610d6b90612ccb565b915050610836565b50508080610d8090612ccb565b915050610765565b508192505050919050565b610d9b611d5e565b610da3611d5e565b610e5e836020015160038560000151604051610dbf9190612c25565b90815260200160405180910390206001018054610ddb90612c6b565b80601f0160208091040260200160405190810160405280929190818152602001828054610e0790612c6b565b8015610e545780601f10610e2957610100808354040283529160200191610e54565b820191906000526020600020905b815481529060010190602001808311610e3757829003601f168201915b5050505050611cf1565b610ea9576040518060400160405280600681526020017f6661696c656400000000000000000000000000000000000000000000000000008152508160400181905250809150506116de565b826000015181600001819052506040518060400160405280600781526020017f7375636365737300000000000000000000000000000000000000000000000000815250816040018190525060038360000151604051610f089190612c25565b908152602001604051809103902060020154816020018181525050600060038460000151604051610f399190612c25565b90815260200160405180910390206003015490508067ffffffffffffffff811115610f6757610f66611e05565b5b604051908082528060200260200182016040528015610fa057816020015b610f8d611d86565b815260200190600190039081610f855790505b50826060018190525060005b818110156116d75760038560000151604051610fc89190612c25565b908152602001604051809103902060040160008281526020019081526020016000206000018054610ff890612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461102490612c6b565b80156110715780601f1061104657610100808354040283529160200191611071565b820191906000526020600020905b81548152906001019060200180831161105457829003601f168201915b50505050508360600151828151811061108d5761108c612fc5565b5b602002602001015160000181905250600385600001516040516110b09190612c25565b9081526020016040518091039020600401600082815260200190815260200160002060010154836060015182815181106110ed576110ec612fc5565b5b60200260200101516020018181525050600385600001516040516111119190612c25565b908152602001604051809103902060040160008281526020019081526020016000206004015467ffffffffffffffff8111156111505761114f611e05565b5b60405190808252806020026020018201604052801561118957816020015b611176611da7565b81526020019060019003908161116e5790505b50836060015182815181106111a1576111a0612fc5565b5b60200260200101516040018190525060005b600386600001516040516111c79190612c25565b90815260200160405180910390206004016000838152602001908152602001600020600401548110156116c357600386600001516040516112089190612c25565b908152602001604051809103902060040160008381526020019081526020016000206005016000828152602001908152602001600020600001805461124c90612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461127890612c6b565b80156112c55780601f1061129a576101008083540402835291602001916112c5565b820191906000526020600020905b8154815290600101906020018083116112a857829003601f168201915b5050505050846060015183815181106112e1576112e0612fc5565b5b60200260200101516040015182815181106112ff576112fe612fc5565b5b6020026020010151600001819052506000600387600001516040516113249190612c25565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206001015490508067ffffffffffffffff81111561137a57611379611e05565b5b6040519080825280602002602001820160405280156113b357816020015b6113a0611dc1565b8152602001906001900390816113985790505b50856060015184815181106113cb576113ca612fc5565b5b60200260200101516040015183815181106113e9576113e8612fc5565b5b60200260200101516020018190525060005b818110156116ae57600388600001516040516114179190612c25565b9081526020016040518091039020600401600085815260200190815260200160002060050160008481526020019081526020016000206002016000828152602001908152602001600020600001805461146f90612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461149b90612c6b565b80156114e85780601f106114bd576101008083540402835291602001916114e8565b820191906000526020600020905b8154815290600101906020018083116114cb57829003601f168201915b50505050508660600151858151811061150457611503612fc5565b5b602002602001015160400151848151811061152257611521612fc5565b5b60200260200101516020015182815181106115405761153f612fc5565b5b602002602001015160000181905250600388600001516040516115639190612c25565b908152602001604051809103902060040160008581526020019081526020016000206005016000848152602001908152602001600020600201600082815260200190815260200160002060010180546115bb90612c6b565b80601f01602080910402602001604051908101604052809291908181526020018280546115e790612c6b565b80156116345780601f1061160957610100808354040283529160200191611634565b820191906000526020600020905b81548152906001019060200180831161161757829003601f168201915b5050505050866060015185815181106116505761164f612fc5565b5b602002602001015160400151848151811061166e5761166d612fc5565b5b602002602001015160200151828151811061168c5761168b612fc5565b5b60200260200101516020018190525080806116a690612ccb565b9150506113fb565b505080806116bb90612ccb565b9150506111b3565b5080806116cf90612ccb565b915050610fac565b5081925050505b919050565b60005b600382602001516040516116fa9190612c25565b90815260200160405180910390206003015481101561186d5760005b6003836020015160405161172a9190612c25565b90815260200160405180910390206004016000838152602001908152602001600020600401548110156118595761183a6003846020015160405161176e9190612c25565b90815260200160405180910390206004016000848152602001908152602001600020600501600083815260200190815260200160002060000180546117b290612c6b565b80601f01602080910402602001604051908101604052809291908181526020018280546117de90612c6b565b801561182b5780601f106118005761010080835404028352916020019161182b565b820191906000526020600020905b81548152906001019060200180831161180e57829003601f168201915b50505050508460000151611cf1565b15611846575050611be7565b808061185190612ccb565b915050611716565b50808061186590612ccb565b9150506116e6565b5060005b600382602001516040516118859190612c25565b908152602001604051809103902060030154811015611be55761196d600383602001516040516118b59190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060000180546118e590612c6b565b80601f016020809104026020016040519081016040528092919081815260200182805461191190612c6b565b801561195e5780601f106119335761010080835404028352916020019161195e565b820191906000526020600020905b81548152906001019060200180831161194157829003601f168201915b50505050508360400151611cf1565b15611bd2576000600383602001516040516119889190612c25565b9081526020016040518091039020600401600083815260200190815260200160002060040160008154809291906119be90612ccb565b9190505590508260000151600384602001516040516119dd9190612c25565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206000019081611a229190612ef3565b5060005b836060015151811015611bcb5783606001518181518110611a4a57611a49612fc5565b5b60200260200101516000015160038560200151604051611a6a9190612c25565b90815260200160405180910390206004016000858152602001908152602001600020600501600084815260200190815260200160002060020160008381526020019081526020016000206000019081611ac39190612ef3565b5083606001518181518110611adb57611ada612fc5565b5b60200260200101516020015160038560200151604051611afb9190612c25565b90815260200160405180910390206004016000858152602001908152602001600020600501600084815260200190815260200160002060020160008381526020019081526020016000206001019081611b549190612ef3565b5060038460200151604051611b699190612c25565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206001016000815480929190611bb390612ccb565b91905055508080611bc390612ccb565b915050611a26565b5050611be5565b8080611bdd90612ccb565b915050611871565b505b50565b806000015160038260000151604051611c039190612c25565b90815260200160405180910390206000019081611c209190612ef3565b50806020015160038260000151604051611c3a9190612c25565b90815260200160405180910390206001019081611c579190612ef3565b50600060038260000151604051611c6e9190612c25565b908152602001604051809103902060030181905550606460038260000151604051611c999190612c25565b9081526020016040518091039020600201819055506000806000815480929190611cc290612ccb565b9190505590508160000151600260008381526020019081526020016000209081611cec9190612ef3565b505050565b60008180519060200120838051906020012003611d115760019050611d16565b600090505b92915050565b604051806040016040528060608152602001600081525090565b6040518060800160405280606081526020016060815260200160008152602001606081525090565b6040518060800160405280606081526020016000815260200160608152602001606081525090565b60405180606001604052806060815260200160008152602001606081525090565b604051806040016040528060608152602001606081525090565b604051806040016040528060608152602001606081525090565b6000604051905090565b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611e3d82611df4565b810181811067ffffffffffffffff82111715611e5c57611e5b611e05565b5b80604052505050565b6000611e6f611ddb565b9050611e7b8282611e34565b919050565b600080fd5b600080fd5b600080fd5b600067ffffffffffffffff821115611eaa57611ea9611e05565b5b611eb382611df4565b9050602081019050919050565b82818337600083830152505050565b6000611ee2611edd84611e8f565b611e65565b905082815260208101848484011115611efe57611efd611e8a565b5b611f09848285611ec0565b509392505050565b600082601f830112611f2657611f25611e85565b5b8135611f36848260208601611ecf565b91505092915050565b600067ffffffffffffffff821115611f5a57611f59611e05565b5b602082029050602081019050919050565b600080fd5b600060408284031215611f8657611f85611def565b5b611f906040611e65565b9050600082013567ffffffffffffffff811115611fb057611faf611e80565b5b611fbc84828501611f11565b600083015250602082013567ffffffffffffffff811115611fe057611fdf611e80565b5b611fec84828501611f11565b60208301525092915050565b600061200b61200684611f3f565b611e65565b9050808382526020820190506020840283018581111561202e5761202d611f6b565b5b835b8181101561207557803567ffffffffffffffff81111561205357612052611e85565b5b8086016120608982611f70565b85526020850194505050602081019050612030565b5050509392505050565b600082601f83011261209457612093611e85565b5b81356120a4848260208601611ff8565b91505092915050565b6000608082840312156120c3576120c2611def565b5b6120cd6080611e65565b9050600082013567ffffffffffffffff8111156120ed576120ec611e80565b5b6120f984828501611f11565b600083015250602082013567ffffffffffffffff81111561211d5761211c611e80565b5b61212984828501611f11565b602083015250604082013567ffffffffffffffff81111561214d5761214c611e80565b5b61215984828501611f11565b604083015250606082013567ffffffffffffffff81111561217d5761217c611e80565b5b6121898482850161207f565b60608301525092915050565b6000602082840312156121ab576121aa611de5565b5b600082013567ffffffffffffffff8111156121c9576121c8611dea565b5b6121d5848285016120ad565b91505092915050565b600081519050919050565b600082825260208201905092915050565b60005b838110156122185780820151818401526020810190506121fd565b83811115612227576000848401525b50505050565b6000612238826121de565b61224281856121e9565b93506122528185602086016121fa565b61225b81611df4565b840191505092915050565b6000819050919050565b61227981612266565b82525050565b6000604083016000830151848203600086015261229c828261222d565b91505060208301516122b16020860182612270565b508091505092915050565b600060208201905081810360008301526122d6818461227f565b905092915050565b6122e781612266565b81146122f257600080fd5b50565b600081359050612304816122de565b92915050565b600067ffffffffffffffff82111561232557612324611e05565b5b602082029050602081019050919050565b60006123496123448461230a565b611e65565b9050808382526020820190506020840283018581111561236c5761236b611f6b565b5b835b818110156123b357803567ffffffffffffffff81111561239157612390611e85565b5b80860161239e8982611f11565b8552602085019450505060208101905061236e565b5050509392505050565b600082601f8301126123d2576123d1611e85565b5b81356123e2848260208601612336565b91505092915050565b60006080828403121561240157612400611def565b5b61240b6080611e65565b9050600082013567ffffffffffffffff81111561242b5761242a611e80565b5b61243784828501611f11565b600083015250602082013567ffffffffffffffff81111561245b5761245a611e80565b5b61246784828501611f11565b602083015250604061247b848285016122f5565b604083015250606082013567ffffffffffffffff81111561249f5761249e611e80565b5b6124ab848285016123bd565b60608301525092915050565b6000602082840312156124cd576124cc611de5565b5b600082013567ffffffffffffffff8111156124eb576124ea611dea565b5b6124f7848285016123eb565b91505092915050565b60006020828403121561251657612515611de5565b5b600082013567ffffffffffffffff81111561253457612533611dea565b5b61254084828501611f11565b91505092915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60006125ad838361222d565b905092915050565b6000602082019050919050565b60006125cd82612575565b6125d78185612580565b9350836020820285016125e985612591565b8060005b85811015612625578484038952815161260685826125a1565b9450612611836125b5565b925060208a019950506001810190506125ed565b50829750879550505050505092915050565b60006080830160008301518482036000860152612654828261222d565b9150506020830151848203602086015261266e828261222d565b91505060408301516126836040860182612270565b506060830151848203606086015261269b82826125c2565b9150508091505092915050565b60006126b48383612637565b905092915050565b6000602082019050919050565b60006126d482612549565b6126de8185612554565b9350836020820285016126f085612565565b8060005b8581101561272c578484038952815161270d85826126a8565b9450612718836126bc565b925060208a019950506001810190506126f4565b50829750879550505050505092915050565b6000602082019050818103600083015261275881846126c9565b905092915050565b60006040828403121561277657612775611def565b5b6127806040611e65565b9050600082013567ffffffffffffffff8111156127a05761279f611e80565b5b6127ac84828501611f11565b600083015250602082013567ffffffffffffffff8111156127d0576127cf611e80565b5b6127dc84828501611f11565b60208301525092915050565b6000602082840312156127fe576127fd611de5565b5b600082013567ffffffffffffffff81111561281c5761281b611dea565b5b61282884828501612760565b91505092915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600060408301600083015184820360008601526128d2828261222d565b915050602083015184820360208601526128ec828261222d565b9150508091505092915050565b600061290583836128b5565b905092915050565b6000602082019050919050565b600061292582612889565b61292f8185612894565b935083602082028501612941856128a5565b8060005b8581101561297d578484038952815161295e85826128f9565b94506129698361290d565b925060208a01995050600181019050612945565b50829750879550505050505092915050565b600060408301600083015184820360008601526129ac828261222d565b915050602083015184820360208601526129c6828261291a565b9150508091505092915050565b60006129df838361298f565b905092915050565b6000602082019050919050565b60006129ff8261285d565b612a098185612868565b935083602082028501612a1b85612879565b8060005b85811015612a575784840389528151612a3885826129d3565b9450612a43836129e7565b925060208a01995050600181019050612a1f565b50829750879550505050505092915050565b60006060830160008301518482036000860152612a86828261222d565b9150506020830151612a9b6020860182612270565b5060408301518482036040860152612ab382826129f4565b9150508091505092915050565b6000612acc8383612a69565b905092915050565b6000602082019050919050565b6000612aec82612831565b612af6818561283c565b935083602082028501612b088561284d565b8060005b85811015612b445784840389528151612b258582612ac0565b9450612b3083612ad4565b925060208a01995050600181019050612b0c565b50829750879550505050505092915050565b60006080830160008301518482036000860152612b73828261222d565b9150506020830151612b886020860182612270565b5060408301518482036040860152612ba0828261222d565b91505060608301518482036060860152612bba8282612ae1565b9150508091505092915050565b60006020820190508181036000830152612be18184612b56565b905092915050565b600081905092915050565b6000612bff826121de565b612c098185612be9565b9350612c198185602086016121fa565b80840191505092915050565b6000612c318284612bf4565b915081905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680612c8357607f821691505b602082108103612c9657612c95612c3c565b5b50919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000612cd682612266565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203612d0857612d07612c9c565b5b600182019050919050565b6000612d1e82612266565b9150612d2983612266565b925082821015612d3c57612d3b612c9c565b5b828203905092915050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302612da97fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82612d6c565b612db38683612d6c565b95508019841693508086168417925050509392505050565b6000819050919050565b6000612df0612deb612de684612266565b612dcb565b612266565b9050919050565b6000819050919050565b612e0a83612dd5565b612e1e612e1682612df7565b848454612d79565b825550505050565b600090565b612e33612e26565b612e3e818484612e01565b505050565b5b81811015612e6257612e57600082612e2b565b600181019050612e44565b5050565b601f821115612ea757612e7881612d47565b612e8184612d5c565b81016020851015612e90578190505b612ea4612e9c85612d5c565b830182612e43565b50505b505050565b600082821c905092915050565b6000612eca60001984600802612eac565b1980831691505092915050565b6000612ee38383612eb9565b9150826002028217905092915050565b612efc826121de565b67ffffffffffffffff811115612f1557612f14611e05565b5b612f1f8254612c6b565b612f2a828285612e66565b600060209050601f831160018114612f5d5760008415612f4b578287015190505b612f558582612ed7565b865550612fbd565b601f198416612f6b86612d47565b60005b82811015612f9357848901518255600182019150602085019450602081019050612f6e565b86831015612fb05784890151612fac601f891682612eb9565b8355505b6001600288020188555050505b505050505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fdfea2646970667358221220e781893e6856c999f054ed9541ab3ed82b482e94371eb9f781947fd278fcb29464736f6c634300080f0033";
        public MarketPlaceDeploymentBase() : base(BYTECODE) { }
        public MarketPlaceDeploymentBase(string byteCode) : base(byteCode) { }

    }

    public partial class AddDataPackFunction : AddDataPackFunctionBase { }

    [Function("addDataPack")]
    public class AddDataPackFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual AddDataPackRequest Request { get; set; }
    }

    public partial class BuyDataFunction : BuyDataFunctionBase { }

    [Function("buyData")]
    public class BuyDataFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual BuyDataRequest Request { get; set; }
    }

    public partial class BuyDataFunction1 : BuyDataFunctionBase1 { }

    [Function("buyData1", typeof(BuyDataOutputDTO))]
    public class BuyDataFunctionBase1 : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual BuyDataRequest Request { get; set; }
    }

    public partial class CreateOrganizationFunction : CreateOrganizationFunctionBase { }

    [Function("createOrganization")]
    public class CreateOrganizationFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual CreateOrgRequest Request { get; set; }
    }

    public partial class GetAllOrganizationsFunction : GetAllOrganizationsFunctionBase { }

    [Function("getAllOrganizations", typeof(GetAllOrganizationsOutputDTO))]
    public class GetAllOrganizationsFunctionBase : FunctionMessage
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
    }

    public partial class GetOrganizationFunction : GetOrganizationFunctionBase { }

    [Function("getOrganization", typeof(GetOrganizationOutputDTO))]
    public class GetOrganizationFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual CreateOrgRequest Request { get; set; }
    }



    public partial class BuyDataOutputDTO : BuyDataOutputDTOBase { }

    [FunctionOutput]
    public class BuyDataOutputDTOBase : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual BuyDataResponse ReturnValue1 { get; set; }
    }



    public partial class GetAllOrganizationsOutputDTO : GetAllOrganizationsOutputDTOBase { }

    [FunctionOutput]
    public class GetAllOrganizationsOutputDTOBase : IFunctionOutputDTO
    {
        [Parameter("tuple[]", "", 1)]
        public virtual List<AllOrganizationResponse> ReturnValue1 { get; set; }
    }

    public partial class GetOrganizationOutputDTO : GetOrganizationOutputDTOBase { }

    [FunctionOutput]
    public class GetOrganizationOutputDTOBase : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual OrganizationResponse ReturnValue1 { get; set; }
    }

    public partial class AddDataPackRequest : AddDataPackRequestBase { }

    public class AddDataPackRequestBase
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual BigInteger PricePerUnit { get; set; }
        [Parameter("string[]", "requestedAttributes", 4)]
        public virtual List<string> RequestedAttributes { get; set; }
    }

    public partial class BuyDataResponse : BuyDataResponseBase { }

    public class BuyDataResponseBase
    {
        [Parameter("string", "status", 1)]
        public virtual string Status { get; set; }
        [Parameter("uint256", "amount", 2)]
        public virtual BigInteger Amount { get; set; }
    }

    public partial class BuyDataRequest : BuyDataRequestBase { }

    public class BuyDataRequestBase
    {
        [Parameter("string", "userID", 1)]
        public virtual string UserID { get; set; }
        [Parameter("string", "organization", 2)]
        public virtual string Organization { get; set; }
        [Parameter("string", "dataPackID", 3)]
        public virtual string DataPackID { get; set; }
        [Parameter("tuple[]", "attributes", 4)]
        public virtual List<Attribute> Attributes { get; set; }
    }

    public partial class CreateOrgRequest : CreateOrgRequestBase { }

    public class CreateOrgRequestBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("string", "password", 2)]
        public virtual string Password { get; set; }
    }

    public partial class AllOrganizationResponse : AllOrganizationResponseBase { }

    public class AllOrganizationResponseBase
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual BigInteger PricePerUnit { get; set; }
        [Parameter("string[]", "attributes", 4)]
        public virtual List<string> Attributes { get; set; }
    }

    public partial class DataPackReceivedRequest : DataPackReceivedRequestBase { }

    public class DataPackReceivedRequestBase
    {
        [Parameter("string", "userID", 1)]
        public virtual string UserID { get; set; }
        [Parameter("tuple[]", "attributes", 2)]
        public virtual List<Attribute> Attributes { get; set; }
    }

    public partial class DataPackResponse : DataPackResponseBase { }

    public class DataPackResponseBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 2)]
        public virtual BigInteger PricePerUnit { get; set; }
        [Parameter("tuple[]", "received", 3)]
        public virtual List<DataPackReceivedRequest> Received { get; set; }
    }

    public partial class OrganizationResponse : OrganizationResponseBase { }

    public class OrganizationResponseBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "balance", 2)]
        public virtual BigInteger Balance { get; set; }
        [Parameter("string", "status", 3)]
        public virtual string Status { get; set; }
        [Parameter("tuple[]", "packs", 4)]
        public virtual List<DataPackResponse> Packs { get; set; }
    }




    public partial class GetAllOrganizationsOutputDTO2 : GetAllOrganizationsOutputDTOBase2 { }

    [FunctionOutput]
    public class GetAllOrganizationsOutputDTOBase2 : IFunctionOutputDTO
    {
        [Parameter("tuple[]", "", 1)]
        public virtual List<AllOrganizationResponse2> ReturnValue1 { get; set; }
    }

    public partial class AllOrganizationResponse2 : AllOrganizationResponseBase2 { }

    public class AllOrganizationResponseBase2
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual int PricePerUnit { get; set; }
        [Parameter("string[]", "attributes", 4)]
        public virtual List<string> Attributes { get; set; }
    }





    public partial class DataPackResponse2 : DataPackResponseBase2 { }

    public class DataPackResponseBase2
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 2)]
        public virtual int PricePerUnit { get; set; }
        [Parameter("tuple[]", "received", 3)]
        public virtual List<DataPackReceivedRequest> Received { get; set; }
    }
    public partial class GetOrganizationOutputDTO2 : GetOrganizationOutputDTOBase2 { }

    [FunctionOutput]
    public class GetOrganizationOutputDTOBase2 : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual OrganizationResponse2 ReturnValue1 { get; set; }
    }

    public partial class OrganizationResponse2 : OrganizationResponseBase2 { }

    public class OrganizationResponseBase2
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "balance", 2)]
        public virtual int Balance { get; set; }
        [Parameter("string", "status", 3)]
        public virtual string Status { get; set; }
        [Parameter("tuple[]", "packs", 4)]
        public virtual List<DataPackResponse2> Packs { get; set; }
    }

    public partial class AddDataPackRequest2 : AddDataPackRequestBase2 { }

    public class AddDataPackRequestBase2
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual int PricePerUnit { get; set; }
        [Parameter("string[]", "requestedAttributes", 4)]
        public virtual List<string> RequestedAttributes { get; set; }
    }

    public partial class BuyDataResponse2 : BuyDataResponseBase2 { }

    public class BuyDataResponseBase2
    {
        [Parameter("string", "status", 1)]
        public virtual string Status { get; set; }
        [Parameter("uint256", "amount", 2)]
        public virtual int Amount { get; set; }
    }
    public partial class BuyDataOutputDTO2 : BuyDataOutputDTOBase2 { }

    [FunctionOutput]
    public class BuyDataOutputDTOBase2 : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual BuyDataResponse2 ReturnValue1 { get; set; }
    }
}
