using ExploringSelfSovereignIdentityAPI.Models.Request;
using ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain;
using ExploringSelfSovereignIdentityAPI.Services.UserDataService;
using MediatR;
using Nethereum.ABI.FunctionEncoding.Attributes;
using Nethereum.Contracts;
using Nethereum.Contracts.ContractHandlers;
using Nethereum.Contracts.DeploymentHandlers;
using Nethereum.Web3;
using Org.BouncyCastle.Asn1.Mozilla;
using Org.BouncyCastle.Asn1.Ocsp;
using System;
using System.Collections.Generic;
using System.Numerics;
using System.Threading.Tasks;
using Attribute = ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain.Attribute;
using IUserDataService = ExploringSelfSovereignIdentityAPI.Services.NetheriumBlockChain.IUserDataService;

namespace ExploringSelfSovereignIdentityAPI.Services
{
    public class MarketPlaceService : IMarketPlaceService
    {

        /*static string url = "http://127.0.0.1:8545";
        static string privateKey = "734674bd34f2476f15c6d5f6c8c1c7c92e465921e546771d088b958607531d10";
        private readonly string senderAddress = "0x8A1f48B91fbDC94b82E1997c2630466c5FaCf38b";
        private static string contractAddress = "0x7D6FAec0a4833Ad806EBCbe7d1BFe66caCF0a961";

        static Web3 web3 = new Web3(new Nethereum.Web3.Accounts.Account(privateKey), url);

        private ContractHandler contractHandler = web3.Eth.GetContractHandler(contractAddress);

        public MarketPlaceService()
        {
            web3.TransactionManager.UseLegacyAsDefault = true;
        }*/

        private static string url = "http://testchain.nethereum.com:8545";
        private static string privateKey = "0x7580e7fb49df1c861f0050fae31c2224c6aba908e116b8da44ee8cd927b990b0";
        static Web3 web3 = new Web3(new Nethereum.Web3.Accounts.Account(privateKey, 444444444500), url);

        private static ContractHandler contractHandler;

        private IUserDataService userData;

        public MarketPlaceService(IUserDataService userData)
        {
            this.userData = userData;
        }

        private async Task<ContractHandler> deploy()
        {
            var marketPlaceDeployment = new MarketPlaceDeployment();

            var transactionReceiptDeployment = await web3.Eth.GetContractDeploymentHandler<MarketPlaceDeployment>().SendRequestAndWaitForReceiptAsync(marketPlaceDeployment);
            var contractAddress = transactionReceiptDeployment.ContractAddress;
            
            return web3.Eth.GetContractHandler(contractAddress);
        }

        public async Task<string> addDataPack(AddDataPackRequest2 request)
        {

            if (contractHandler == null) contractHandler = await deploy();

            var addDataPackFunction = new AddDataPackFunction();
            addDataPackFunction.Request = new AddDataPackRequest();
            addDataPackFunction.Request.Id = request.Id;
            addDataPackFunction.Request.PricePerUnit = request.PricePerUnit;
            addDataPackFunction.Request.Organization = request.Organization;
            addDataPackFunction.Request.RequestedAttributes = request.RequestedAttributes;
            var addDataPackFunctionTxnReceipt = await contractHandler.SendRequestAndWaitForReceiptAsync(addDataPackFunction);

            return "success";
        }

        public async Task<BuyDataOutputDTO2> buyData(BuyDataRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var buyDataFunction = new BuyDataFunction();
            buyDataFunction.Request = request;
            BuyDataOutputDTO buyDataFunctionTxnReceipt = await contractHandler.QueryDeserializingToObjectAsync<BuyDataFunction, BuyDataOutputDTO>(buyDataFunction);

            if (buyDataFunctionTxnReceipt.ReturnValue1.Status == "success")
            {
                await userData.updateBalance(request.UserID, (int) buyDataFunctionTxnReceipt.ReturnValue1.Amount);
            }

            BuyDataOutputDTO2 ret = new BuyDataOutputDTO2();
            ret.ReturnValue1 = new BuyDataResponse2();
            ret.ReturnValue1.Status = buyDataFunctionTxnReceipt.ReturnValue1.Status;
            ret.ReturnValue1.Amount = (int) buyDataFunctionTxnReceipt.ReturnValue1.Amount;

            return ret;
        }

        public async Task<string> createOrganization(CreateOrgRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var createOrganizationFunction = new CreateOrganizationFunction();
            createOrganizationFunction.Request = request;
            var createOrganizationFunctionTxnReceipt = await contractHandler.SendRequestAndWaitForReceiptAsync(createOrganizationFunction);

            return "success";
        }

        public async Task<GetOrganizationOutputDTO2> getOrganization(CreateOrgRequest request)
        {
            if (contractHandler == null) contractHandler = await deploy();

            var getOrganizationFunction = new GetOrganizationFunction();
            getOrganizationFunction.Request = request;
            var getOrganizationOutputDTO = await contractHandler.QueryDeserializingToObjectAsync<GetOrganizationFunction, GetOrganizationOutputDTO>(getOrganizationFunction);

            GetOrganizationOutputDTO2 ret = new GetOrganizationOutputDTO2();
            ret.ReturnValue1 = new OrganizationResponse2();

            ret.ReturnValue1.Id = getOrganizationOutputDTO.ReturnValue1.Id;
            ret.ReturnValue1.Balance = (int) getOrganizationOutputDTO.ReturnValue1.Balance;
            ret.ReturnValue1.Status = getOrganizationOutputDTO.ReturnValue1.Status;

            ret.ReturnValue1.Packs = new List<DataPackResponse2>();

            for (int i=0; i< getOrganizationOutputDTO.ReturnValue1.Packs.Count; i++)
            {
                DataPackResponse2 p = new DataPackResponse2();
                p.Id = getOrganizationOutputDTO.ReturnValue1.Packs[i].Id;
                p.PricePerUnit = (int) getOrganizationOutputDTO.ReturnValue1.Packs[i].PricePerUnit;
                p.Received = getOrganizationOutputDTO.ReturnValue1.Packs[i].Received;

                ret.ReturnValue1.Packs.Add(p);
            }

            return ret;
        }
    }

    public partial class MarketPlaceDeployment : MarketPlaceDeploymentBase
    {
        public MarketPlaceDeployment() : base(BYTECODE) { }
        public MarketPlaceDeployment(string byteCode) : base(byteCode) { }
    }

    public class MarketPlaceDeploymentBase : ContractDeploymentMessage
    {
        public static string BYTECODE = "0x608060405234801561001057600080fd5b5061239b806100206000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c806317d104f81461005157806373001f801461006d578063804a18b81461009d5780638d0f9c68146100cd575b600080fd5b61006b600480360381019061006691906116f8565b6100e9565b005b610087600480360381019061008291906117c9565b6102d2565b6040516100949190611c3f565b60405180910390f35b6100b760048036038101906100b29190611eb2565b610c20565b6040516100c49190611f38565b60405180910390f35b6100e760048036038101906100e291906117c9565b611224565b005b60008082600001516040516100fe9190611f96565b9081526020016040518091039020600301600081548092919061012090611fdc565b91905055905081602001516000836000015160405161013f9190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060000190816101709190612230565b5081604001516000836000015160405161018a9190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060010181905550816060015151600083600001516040516101cd9190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060020181905550600080836000015160405161020b9190611f96565b908152602001604051809103902060040160008381526020019081526020016000206004018190555060005b8260600151518110156102cd578260600151818151811061025b5761025a612302565b5b6020026020010151600084600001516040516102779190611f96565b90815260200160405180910390206004016000848152602001908152602001600020600301600083815260200190815260200160002090816102b99190612230565b5080806102c590611fdc565b915050610237565b505050565b6102da611315565b6102e2611315565b61039d8360200151600085600001516040516102fe9190611f96565b9081526020016040518091039020600101805461031a90612053565b80601f016020809104026020016040519081016040528092919081815260200182805461034690612053565b80156103935780601f1061036857610100808354040283529160200191610393565b820191906000526020600020905b81548152906001019060200180831161037657829003601f168201915b50505050506112ea565b6103e8576040518060400160405280600681526020017f6661696c65640000000000000000000000000000000000000000000000000000815250816040018190525080915050610c1b565b826000015181600001819052506040518060400160405280600781526020017f73756363657373000000000000000000000000000000000000000000000000008152508160400181905250600083600001516040516104479190611f96565b90815260200160405180910390206002015481602001818152505060008084600001516040516104779190611f96565b90815260200160405180910390206003015490508067ffffffffffffffff8111156104a5576104a46113d6565b5b6040519080825280602002602001820160405280156104de57816020015b6104cb61133d565b8152602001906001900390816104c35790505b50826060018190525060005b81811015610c1457600085600001516040516105069190611f96565b90815260200160405180910390206004016000828152602001908152602001600020600001805461053690612053565b80601f016020809104026020016040519081016040528092919081815260200182805461056290612053565b80156105af5780601f10610584576101008083540402835291602001916105af565b820191906000526020600020905b81548152906001019060200180831161059257829003601f168201915b5050505050836060015182815181106105cb576105ca612302565b5b602002602001015160000181905250600085600001516040516105ee9190611f96565b90815260200160405180910390206004016000828152602001908152602001600020600101548360600151828151811061062b5761062a612302565b5b602002602001015160200181815250506000856000015160405161064f9190611f96565b908152602001604051809103902060040160008281526020019081526020016000206004015467ffffffffffffffff81111561068e5761068d6113d6565b5b6040519080825280602002602001820160405280156106c757816020015b6106b461135e565b8152602001906001900390816106ac5790505b50836060015182815181106106df576106de612302565b5b60200260200101516040018190525060005b600086600001516040516107059190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060040154811015610c0057600086600001516040516107469190611f96565b908152602001604051809103902060040160008381526020019081526020016000206005016000828152602001908152602001600020600001805461078a90612053565b80601f01602080910402602001604051908101604052809291908181526020018280546107b690612053565b80156108035780601f106107d857610100808354040283529160200191610803565b820191906000526020600020905b8154815290600101906020018083116107e657829003601f168201915b50505050508460600151838151811061081f5761081e612302565b5b602002602001015160400151828151811061083d5761083c612302565b5b60200260200101516000018190525060008087600001516040516108619190611f96565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206001015490508067ffffffffffffffff8111156108b7576108b66113d6565b5b6040519080825280602002602001820160405280156108f057816020015b6108dd611378565b8152602001906001900390816108d55790505b508560600151848151811061090857610907612302565b5b602002602001015160400151838151811061092657610925612302565b5b60200260200101516020018190525060005b81811015610beb57600088600001516040516109549190611f96565b908152602001604051809103902060040160008581526020019081526020016000206005016000848152602001908152602001600020600201600082815260200190815260200160002060000180546109ac90612053565b80601f01602080910402602001604051908101604052809291908181526020018280546109d890612053565b8015610a255780601f106109fa57610100808354040283529160200191610a25565b820191906000526020600020905b815481529060010190602001808311610a0857829003601f168201915b505050505086606001518581518110610a4157610a40612302565b5b6020026020010151604001518481518110610a5f57610a5e612302565b5b6020026020010151602001518281518110610a7d57610a7c612302565b5b60200260200101516000018190525060008860000151604051610aa09190611f96565b90815260200160405180910390206004016000858152602001908152602001600020600501600084815260200190815260200160002060020160008281526020019081526020016000206001018054610af890612053565b80601f0160208091040260200160405190810160405280929190818152602001828054610b2490612053565b8015610b715780601f10610b4657610100808354040283529160200191610b71565b820191906000526020600020905b815481529060010190602001808311610b5457829003601f168201915b505050505086606001518581518110610b8d57610b8c612302565b5b6020026020010151604001518481518110610bab57610baa612302565b5b6020026020010151602001518281518110610bc957610bc8612302565b5b6020026020010151602001819052508080610be390611fdc565b915050610938565b50508080610bf890611fdc565b9150506106f1565b508080610c0c90611fdc565b9150506104ea565b5081925050505b919050565b610c28611392565b610c30611392565b60005b60008460200151604051610c479190611f96565b90815260200160405180910390206003015481101561121957610d2f60008560200151604051610c779190611f96565b908152602001604051809103902060040160008381526020019081526020016000206000018054610ca790612053565b80601f0160208091040260200160405190810160405280929190818152602001828054610cd390612053565b8015610d205780601f10610cf557610100808354040283529160200191610d20565b820191906000526020600020905b815481529060010190602001808311610d0357829003601f168201915b505050505085604001516112ea565b156112065760005b60008560200151604051610d4b9190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060040154811015610ebc57610e5b60008660200151604051610d8f9190611f96565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206000018054610dd390612053565b80601f0160208091040260200160405190810160405280929190818152602001828054610dff90612053565b8015610e4c5780601f10610e2157610100808354040283529160200191610e4c565b820191906000526020600020905b815481529060010190602001808311610e2f57829003601f168201915b505050505086600001516112ea565b15610ea9576040518060400160405280600681526020017f6661696c65640000000000000000000000000000000000000000000000000000815250836000018190525082935050505061121f565b8080610eb490611fdc565b915050610d37565b506000808560200151604051610ed29190611f96565b908152602001604051809103902060040160008381526020019081526020016000206004016000815480929190610f0890611fdc565b919050559050846000015160008660200151604051610f279190611f96565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206000019081610f6c9190612230565b5084606001515160008660200151604051610f879190611f96565b9081526020016040518091039020600401600084815260200190815260200160002060050160008381526020019081526020016000206001018190555060005b8560600151518110156111095785606001518181518110610feb57610fea612302565b5b6020026020010151600001516000876020015160405161100b9190611f96565b908152602001604051809103902060040160008581526020019081526020016000206005016000848152602001908152602001600020600201600083815260200190815260200160002060000190816110649190612230565b508560600151818151811061107c5761107b612302565b5b6020026020010151602001516000876020015160405161109c9190611f96565b908152602001604051809103902060040160008581526020019081526020016000206005016000848152602001908152602001600020600201600083815260200190815260200160002060010190816110f59190612230565b50808061110190611fdc565b915050610fc7565b506040518060400160405280600781526020017f737563636573730000000000000000000000000000000000000000000000000081525083600001819052506000856020015160405161115c9190611f96565b90815260200160405180910390206004016000838152602001908152602001600020600101548360200181815250506000856020015160405161119f9190611f96565b9081526020016040518091039020600401600083815260200190815260200160002060010154600086602001516040516111d99190611f96565b908152602001604051809103902060020160008282546111f99190612331565b9250508190555050611219565b808061121190611fdc565b915050610c33565b50809150505b919050565b80600001516000826000015160405161123d9190611f96565b9081526020016040518091039020600001908161125a9190612230565b508060200151600082600001516040516112749190611f96565b908152602001604051809103902060010190816112919190612230565b5060008082600001516040516112a79190611f96565b9081526020016040518091039020600301819055506064600082600001516040516112d29190611f96565b90815260200160405180910390206002018190555050565b6000818051906020012083805190602001200361130a576001905061130f565b600090505b92915050565b6040518060800160405280606081526020016000815260200160608152602001606081525090565b60405180606001604052806060815260200160008152602001606081525090565b604051806040016040528060608152602001606081525090565b604051806040016040528060608152602001606081525090565b604051806040016040528060608152602001600081525090565b6000604051905090565b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61140e826113c5565b810181811067ffffffffffffffff8211171561142d5761142c6113d6565b5b80604052505050565b60006114406113ac565b905061144c8282611405565b919050565b600080fd5b600080fd5b600080fd5b600067ffffffffffffffff82111561147b5761147a6113d6565b5b611484826113c5565b9050602081019050919050565b82818337600083830152505050565b60006114b36114ae84611460565b611436565b9050828152602081018484840111156114cf576114ce61145b565b5b6114da848285611491565b509392505050565b600082601f8301126114f7576114f6611456565b5b81356115078482602086016114a0565b91505092915050565b6000819050919050565b61152381611510565b811461152e57600080fd5b50565b6000813590506115408161151a565b92915050565b600067ffffffffffffffff821115611561576115606113d6565b5b602082029050602081019050919050565b600080fd5b600061158a61158584611546565b611436565b905080838252602082019050602084028301858111156115ad576115ac611572565b5b835b818110156115f457803567ffffffffffffffff8111156115d2576115d1611456565b5b8086016115df89826114e2565b855260208501945050506020810190506115af565b5050509392505050565b600082601f83011261161357611612611456565b5b8135611623848260208601611577565b91505092915050565b600060808284031215611642576116416113c0565b5b61164c6080611436565b9050600082013567ffffffffffffffff81111561166c5761166b611451565b5b611678848285016114e2565b600083015250602082013567ffffffffffffffff81111561169c5761169b611451565b5b6116a8848285016114e2565b60208301525060406116bc84828501611531565b604083015250606082013567ffffffffffffffff8111156116e0576116df611451565b5b6116ec848285016115fe565b60608301525092915050565b60006020828403121561170e5761170d6113b6565b5b600082013567ffffffffffffffff81111561172c5761172b6113bb565b5b6117388482850161162c565b91505092915050565b600060408284031215611757576117566113c0565b5b6117616040611436565b9050600082013567ffffffffffffffff81111561178157611780611451565b5b61178d848285016114e2565b600083015250602082013567ffffffffffffffff8111156117b1576117b0611451565b5b6117bd848285016114e2565b60208301525092915050565b6000602082840312156117df576117de6113b6565b5b600082013567ffffffffffffffff8111156117fd576117fc6113bb565b5b61180984828501611741565b91505092915050565b600081519050919050565b600082825260208201905092915050565b60005b8381101561184c578082015181840152602081019050611831565b8381111561185b576000848401525b50505050565b600061186c82611812565b611876818561181d565b935061188681856020860161182e565b61188f816113c5565b840191505092915050565b6118a381611510565b82525050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b6000604083016000830151848203600086015261194a8282611861565b915050602083015184820360208601526119648282611861565b9150508091505092915050565b600061197d838361192d565b905092915050565b6000602082019050919050565b600061199d82611901565b6119a7818561190c565b9350836020820285016119b98561191d565b8060005b858110156119f557848403895281516119d68582611971565b94506119e183611985565b925060208a019950506001810190506119bd565b50829750879550505050505092915050565b60006040830160008301518482036000860152611a248282611861565b91505060208301518482036020860152611a3e8282611992565b9150508091505092915050565b6000611a578383611a07565b905092915050565b6000602082019050919050565b6000611a77826118d5565b611a8181856118e0565b935083602082028501611a93856118f1565b8060005b85811015611acf5784840389528151611ab08582611a4b565b9450611abb83611a5f565b925060208a01995050600181019050611a97565b50829750879550505050505092915050565b60006060830160008301518482036000860152611afe8282611861565b9150506020830151611b13602086018261189a565b5060408301518482036040860152611b2b8282611a6c565b9150508091505092915050565b6000611b448383611ae1565b905092915050565b6000602082019050919050565b6000611b64826118a9565b611b6e81856118b4565b935083602082028501611b80856118c5565b8060005b85811015611bbc5784840389528151611b9d8582611b38565b9450611ba883611b4c565b925060208a01995050600181019050611b84565b50829750879550505050505092915050565b60006080830160008301518482036000860152611beb8282611861565b9150506020830151611c00602086018261189a565b5060408301518482036040860152611c188282611861565b91505060608301518482036060860152611c328282611b59565b9150508091505092915050565b60006020820190508181036000830152611c598184611bce565b905092915050565b600067ffffffffffffffff821115611c7c57611c7b6113d6565b5b602082029050602081019050919050565b600060408284031215611ca357611ca26113c0565b5b611cad6040611436565b9050600082013567ffffffffffffffff811115611ccd57611ccc611451565b5b611cd9848285016114e2565b600083015250602082013567ffffffffffffffff811115611cfd57611cfc611451565b5b611d09848285016114e2565b60208301525092915050565b6000611d28611d2384611c61565b611436565b90508083825260208201905060208402830185811115611d4b57611d4a611572565b5b835b81811015611d9257803567ffffffffffffffff811115611d7057611d6f611456565b5b808601611d7d8982611c8d565b85526020850194505050602081019050611d4d565b5050509392505050565b600082601f830112611db157611db0611456565b5b8135611dc1848260208601611d15565b91505092915050565b600060808284031215611de057611ddf6113c0565b5b611dea6080611436565b9050600082013567ffffffffffffffff811115611e0a57611e09611451565b5b611e16848285016114e2565b600083015250602082013567ffffffffffffffff811115611e3a57611e39611451565b5b611e46848285016114e2565b602083015250604082013567ffffffffffffffff811115611e6a57611e69611451565b5b611e76848285016114e2565b604083015250606082013567ffffffffffffffff811115611e9a57611e99611451565b5b611ea684828501611d9c565b60608301525092915050565b600060208284031215611ec857611ec76113b6565b5b600082013567ffffffffffffffff811115611ee657611ee56113bb565b5b611ef284828501611dca565b91505092915050565b60006040830160008301518482036000860152611f188282611861565b9150506020830151611f2d602086018261189a565b508091505092915050565b60006020820190508181036000830152611f528184611efb565b905092915050565b600081905092915050565b6000611f7082611812565b611f7a8185611f5a565b9350611f8a81856020860161182e565b80840191505092915050565b6000611fa28284611f65565b915081905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000611fe782611510565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361201957612018611fad565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061206b57607f821691505b60208210810361207e5761207d612024565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026120e67fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826120a9565b6120f086836120a9565b95508019841693508086168417925050509392505050565b6000819050919050565b600061212d61212861212384611510565b612108565b611510565b9050919050565b6000819050919050565b61214783612112565b61215b61215382612134565b8484546120b6565b825550505050565b600090565b612170612163565b61217b81848461213e565b505050565b5b8181101561219f57612194600082612168565b600181019050612181565b5050565b601f8211156121e4576121b581612084565b6121be84612099565b810160208510156121cd578190505b6121e16121d985612099565b830182612180565b50505b505050565b600082821c905092915050565b6000612207600019846008026121e9565b1980831691505092915050565b600061222083836121f6565b9150826002028217905092915050565b61223982611812565b67ffffffffffffffff811115612252576122516113d6565b5b61225c8254612053565b6122678282856121a3565b600060209050601f83116001811461229a5760008415612288578287015190505b6122928582612214565b8655506122fa565b601f1984166122a886612084565b60005b828110156122d0578489015182556001820191506020850194506020810190506122ab565b868310156122ed57848901516122e9601f8916826121f6565b8355505b6001600288020188555050505b505050505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600061233c82611510565b915061234783611510565b92508282101561235a57612359611fad565b5b82820390509291505056fea2646970667358221220738c62b7884bd8f82a1404e15289ef18b8637122ff647a32580f29e3ddfc968664736f6c634300080f0033";
        public MarketPlaceDeploymentBase() : base(BYTECODE) { }
        public MarketPlaceDeploymentBase(string byteCode) : base(byteCode) { }

    }

    public partial class AddDataPackFunction : AddDataPackFunctionBase { }

    [Function("addDataPack")]
    public class AddDataPackFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual AddDataPackRequest Request { get; set; }
    }

    public partial class BuyDataFunction : BuyDataFunctionBase { }

    [Function("buyData", typeof(BuyDataOutputDTO))]
    public class BuyDataFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual BuyDataRequest Request { get; set; }
    }

    public partial class CreateOrganizationFunction : CreateOrganizationFunctionBase { }

    [Function("createOrganization")]
    public class CreateOrganizationFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual CreateOrgRequest Request { get; set; }
    }

    public partial class GetOrganizationFunction : GetOrganizationFunctionBase { }

    [Function("getOrganization", typeof(GetOrganizationOutputDTO))]
    public class GetOrganizationFunctionBase : FunctionMessage
    {
        [Parameter("tuple", "request", 1)]
        public virtual CreateOrgRequest Request { get; set; }
    }



    public partial class BuyDataOutputDTO : BuyDataOutputDTOBase { }

    [FunctionOutput]
    public class BuyDataOutputDTOBase : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual BuyDataResponse ReturnValue1 { get; set; }
    }



    public partial class GetOrganizationOutputDTO : GetOrganizationOutputDTOBase { }

    [FunctionOutput]
    public class GetOrganizationOutputDTOBase : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual OrganizationResponse ReturnValue1 { get; set; }
    }

    public partial class AddDataPackRequest : AddDataPackRequestBase { }

    public class AddDataPackRequestBase
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual BigInteger PricePerUnit { get; set; }
        [Parameter("string[]", "requestedAttributes", 4)]
        public virtual List<string> RequestedAttributes { get; set; }
    }

    public partial class BuyDataResponse : BuyDataResponseBase { }

    public class BuyDataResponseBase
    {
        [Parameter("string", "status", 1)]
        public virtual string Status { get; set; }
        [Parameter("uint256", "amount", 2)]
        public virtual BigInteger Amount { get; set; }
    }

    public partial class BuyDataRequest : BuyDataRequestBase { }

    public class BuyDataRequestBase
    {
        [Parameter("string", "userID", 1)]
        public virtual string UserID { get; set; }
        [Parameter("string", "organization", 2)]
        public virtual string Organization { get; set; }
        [Parameter("string", "dataPackID", 3)]
        public virtual string DataPackID { get; set; }
        [Parameter("tuple[]", "attributes", 4)]
        public virtual List<Attribute> Attributes { get; set; }
    }

    public partial class CreateOrgRequest : CreateOrgRequestBase { }

    public class CreateOrgRequestBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("string", "password", 2)]
        public virtual string Password { get; set; }
    }

    public partial class DataPackReceivedRequest : DataPackReceivedRequestBase { }

    public class DataPackReceivedRequestBase
    {
        [Parameter("string", "userID", 1)]
        public virtual string UserID { get; set; }
        [Parameter("tuple[]", "attributes", 2)]
        public virtual List<Attribute> Attributes { get; set; }
    }

    public partial class DataPackResponse : DataPackResponseBase { }

    public class DataPackResponseBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 2)]
        public virtual BigInteger PricePerUnit { get; set; }
        [Parameter("tuple[]", "received", 3)]
        public virtual List<DataPackReceivedRequest> Received { get; set; }
    }

    public partial class OrganizationResponse : OrganizationResponseBase { }

    public class OrganizationResponseBase
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "balance", 2)]
        public virtual BigInteger Balance { get; set; }
        [Parameter("string", "status", 3)]
        public virtual string Status { get; set; }
        [Parameter("tuple[]", "packs", 4)]
        public virtual List<DataPackResponse> Packs { get; set; }
    }





    public partial class DataPackResponse2 : DataPackResponseBase2 { }

    public class DataPackResponseBase2
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 2)]
        public virtual int PricePerUnit { get; set; }
        [Parameter("tuple[]", "received", 3)]
        public virtual List<DataPackReceivedRequest> Received { get; set; }
    }
    public partial class GetOrganizationOutputDTO2 : GetOrganizationOutputDTOBase2 { }

    [FunctionOutput]
    public class GetOrganizationOutputDTOBase2 : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual OrganizationResponse2 ReturnValue1 { get; set; }
    }

    public partial class OrganizationResponse2 : OrganizationResponseBase2 { }

    public class OrganizationResponseBase2
    {
        [Parameter("string", "id", 1)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "balance", 2)]
        public virtual int Balance { get; set; }
        [Parameter("string", "status", 3)]
        public virtual string Status { get; set; }
        [Parameter("tuple[]", "packs", 4)]
        public virtual List<DataPackResponse2> Packs { get; set; }
    }

    public partial class AddDataPackRequest2 : AddDataPackRequestBase2 { }

    public class AddDataPackRequestBase2
    {
        [Parameter("string", "organization", 1)]
        public virtual string Organization { get; set; }
        [Parameter("string", "id", 2)]
        public virtual string Id { get; set; }
        [Parameter("uint256", "pricePerUnit", 3)]
        public virtual int PricePerUnit { get; set; }
        [Parameter("string[]", "requestedAttributes", 4)]
        public virtual List<string> RequestedAttributes { get; set; }
    }

    public partial class BuyDataResponse2 : BuyDataResponseBase2 { }

    public class BuyDataResponseBase2
    {
        [Parameter("string", "status", 1)]
        public virtual string Status { get; set; }
        [Parameter("uint256", "amount", 2)]
        public virtual int Amount { get; set; }
    }
    public partial class BuyDataOutputDTO2 : BuyDataOutputDTOBase2 { }

    [FunctionOutput]
    public class BuyDataOutputDTOBase2 : IFunctionOutputDTO
    {
        [Parameter("tuple", "", 1)]
        public virtual BuyDataResponse2 ReturnValue1 { get; set; }
    }
}
